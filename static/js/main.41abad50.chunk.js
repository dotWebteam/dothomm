(this.webpackJsonpdothomm=this.webpackJsonpdothomm||[]).push([[0],{14:function(t,n,e){"use strict";e.d(n,"d",(function(){return a})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return r})),e.d(n,"e",(function(){return c}));var a=5,i=8,o=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],r=[{x:0,y:0},{x:0,y:1},{x:0,y:2},{x:0,y:3},{x:0,y:4}],c=[{x:7,y:0},{x:7,y:1},{x:7,y:2},{x:7,y:3},{x:7,y:4}]},37:function(t,n,e){"use strict";var a,i,o=e(16),r=e(18),c=e(17),s=e(26),u=e(40),l=e(39),d=e(6),p=document.querySelector("#root"),A=Object(c.a)(s.animated.div)(a||(a=Object(o.a)(["\n  user-select: none;\n  position: fixed;\n  top: 0;\n  background: #1e171796;\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10;\n\n  cursor: url(",'), auto;\n  @font-face {\n    font-family: "Alagard";\n    src: url(',') format("truetype");\n  }\n  font-family: Alagard;\n  color: #ffe98c;\n  text-shadow: 2px 2px 0 #000;\n'])),l.a,u.a),f=Object(c.a)(s.animated.div)(i||(i=Object(o.a)([""])));n.a=function(t){var n=t.children,e=t.className,a=t.onOutsideClick,i=t.customBackgroundStyle,o=t.customModalStyle,c=Object(s.useSpring)({to:[{opacity:1,marginTop:"0px"}],from:{opacity:0,marginTop:"100px"}}),u=Object(s.useSpring)({to:[{opacity:1}],from:{opacity:0}});return p?Object(r.createPortal)(Object(d.jsx)(A,{onClick:function(t){t.preventDefault(),t.stopPropagation(),a&&a()},className:e,style:i||u,children:Object(d.jsx)(f,{onClick:function(t){t.preventDefault(),t.stopPropagation()},style:o||c,children:n})}),p):null}},38:function(t,n,e){"use strict";e.d(n,"f",(function(){return h})),e.d(n,"g",(function(){return y})),e.d(n,"h",(function(){return O})),e.d(n,"a",(function(){return v})),e.d(n,"c",(function(){return g})),e.d(n,"d",(function(){return j})),e.d(n,"i",(function(){return x})),e.d(n,"b",(function(){return P}));var a=e(5),i=e(23),o=e(11),r=e(41),c=e(2),s=e(14),u=function(t){var n=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]];return t.forEach((function(t){var e=t.coordinates,a=e.x,i=e.y,o=t.unitType,r=t.id;n[i][a]={type:"unit",unitType:o,id:r}})),n=n.map((function(t){return t.map((function(t){return t=!Object(o.random)(0,15)&&Object(o.isEmpty)(t)?{type:"obstacle",id:1,obstacleType:"STONES"}:t}))}))},l=function(t,n,e,a){var i=function(t,n,e,a){var i=t.map((function(t,n){return Object(c.a)(Object(c.a)({},t),{},{owner:e,id:n,viewDirection:"right"})})),o=t.length;return{firstPlayerUnits:i,secondPlayerUnits:n.map((function(t,n){return Object(c.a)(Object(c.a)({},t),{},{owner:a,id:o+n,viewDirection:"left"})}))}}(t,n,e,a),r=function(t,n){var e=Object(o.shuffle)(s.b),a=t.map((function(t){var n=e.pop();if(!n)throw new Error("The number of available coordinates for the first player is less than the number of its units!");return Object(c.a)(Object(c.a)({},t),{},{coordinates:n})})),i=Object(o.shuffle)(s.e);return{firstPlayerUnitsWithCoordinates:a,secondPlayerUnitsWithCoordinates:n.map((function(t){var n=i.pop();if(!n)throw new Error("The number of available coordinates for the second player is less than the number of its units!");return Object(c.a)(Object(c.a)({},t),{},{coordinates:n})}))}}(i.firstPlayerUnits,i.secondPlayerUnits),l=function(t,n){return t.concat(n).sort((function(t,n){return t.actionPoints.max-n.actionPoints.max})).map((function(t,n){return 0===n?Object(c.a)(Object(c.a)({},t),{},{isActive:!0}):Object(c.a)(Object(c.a)({},t),{},{isActive:!1})}))}(r.firstPlayerUnitsWithCoordinates,r.secondPlayerUnitsWithCoordinates);return{units:l,board:u(l)}},d=function(t,n){return{type:"deadBody",id:t,deadBodyType:"DEAD_BODY_".concat(n)}},p=function(t){var n=t.board,e=t.deadUnits,a=t.units,i=t.target,o=i.x,r=i.y,s=function(t,n,e){return t.map((function(t){if(t.coordinates.x===n&&t.coordinates.y===e){var a=t.healthPoints.max*(t.count-1)+t.healthPoints.current-50,i=Math.ceil(a/t.healthPoints.max),o=a%t.healthPoints.max;return Object(c.a)(Object(c.a)({},t),{},{healthPoints:{max:t.healthPoints.max,current:o},count:i})}return t}))}(a,o,r);s.forEach((function(t){t.count<=0&&(s.splice(s.indexOf(t),1),null===e||void 0===e||e.push(t),n[r][o]=d(t.id,t.unitType))}));var u="Magic arrow was casted in square ".concat(o," ").concat(r);return{board:n,units:s,deadUnits:e,lastAction:u}},A=function(t,n,e){switch(n){case"HELM_OF_ALABASTER_UNICORN":return function(t,n){return t.myName===n?t.spellPoints.max=t.spellPoints.current=t.spellPoints.max+2:t.opponentSpellPoints.max=t.opponentSpellPoints.current=t.opponentSpellPoints.max+2,t}(t,e);case"CENTAURS_AXE":return function(t,n){return t.units=t.units.map((function(t){return n===t.owner?Object(c.a)(Object(c.a)({},t),{},{attack:{max:t.attack.max+1,min:t.attack.min}}):t})),t}(t,e);case"RING_OF_VITALITY":return function(t,n){return t.units=t.units.map((function(t){return n===t.owner?Object(c.a)(Object(c.a)({},t),{},{healthPoints:{max:t.healthPoints.max+1,current:t.healthPoints.max+1}}):t})),t}(t,e);case"SHIELD_OF_DWARWEN_LORDS":return function(t,n){return t.units=t.units.map((function(t){return n===t.owner?Object(c.a)(Object(c.a)({},t),{},{defense:t.defense+1}):t})),t}(t,e);case"BOOTS_OF_SPEED":return function(t,n){return t.units=t.units.map((function(t){return n===t.owner?Object(c.a)(Object(c.a)({},t),{},{actionPoints:{max:t.actionPoints.max+1,current:t.actionPoints.max+1}}):t})),t}(t,e)}},f={board:[],units:[],deadUnits:[],lastAction:"The battle has began!",myName:"player 1",opponentName:"player 2",winner:"",isOnline:!1,spellStack:{isCasting:!1,spellName:void 0,cost:0,effectSrc:""},turn:0,spellPoints:{isTired:!1,max:10,current:10},opponentSpellPoints:{isTired:!1,max:10,current:10},backgroundSrc:"BEACH",myArtifacts:[],opponentArtifacts:[]},m=Object(i.b)({name:"game",initialState:f,reducers:{initBoard:function(t,n){var e=n.payload,i=e.firstPlayerUnitTemplates,o=e.secondPlayerUnitTemplates,r=e.opponentName,c=e.userName,s=e.backgroundSrc,u=e.firstPlayerArtifactArr,d=e.secondPlayerArtifactArr;t.opponentName=r;var p=l(i,o,c,r),f=p.units,m=p.board;t.spellStack={isCasting:!1,spellName:void 0,cost:0,effectSrc:""},t.opponentSpellPoints={isTired:!1,max:10,current:10},t.spellPoints={isTired:!1,max:10,current:10},t.units=f,t.board=m,t.winner="",t.lastAction="The battle has began!",t.deadUnits=[],t.turn=0,t.backgroundSrc=s,t.myArtifacts=u,t.opponentArtifacts=d,u.forEach((function(n){t=A(t,n.name,c)})),d.forEach((function(n){t=A(t,n.name,r)})),t.activeUnit=t.units[0];var b=t.activeUnit.owner===c?[c,t.spellPoints,t.myArtifacts,r,t.opponentSpellPoints,t.opponentArtifacts]:[r,t.opponentSpellPoints,t.opponentArtifacts,c,t.spellPoints,t.myArtifacts],h=Object(a.a)(b,6);t.myName=h[0],t.spellPoints=h[1],t.myArtifacts=h[2],t.opponentName=h[3],t.opponentSpellPoints=h[4],t.opponentArtifacts=h[5]},moveToSquare:function(t,n){if(!t.activeUnit)throw Error("No active unit found!");var e=n.payload,a=e.prevX,i=e.prevY,o=e.nextX,c=e.nextY,s=e.id,u=t.units,l=u.findIndex((function(t){return t.id===s})),d=u[l];d.coordinates=t.activeUnit.coordinates={x:o,y:c},t.activeUnit.actionPoints.current-=Object(r.a)(a,i,o,c),t.board[c][o].type="unit",t.board[c][o].unitType=t.board[i][a].unitType,t.board[i][a]={},t.board[c][o].id=s,t.lastAction="".concat(d.unitType," is moving to coordinate ").concat(o," ").concat(c)},nextTurn:function(t,n){var e=n.payload.activeUnit.id,a=t.units,i=a.findIndex((function(t){return t.id===e})),o=(i+1)%a.length;t.lastAction="",o<i&&(++t.turn,t.lastAction+="Turn ".concat(t.turn," has come! "),t.spellPoints.isTired=t.opponentSpellPoints.isTired=!1);var r=a[o];if(t.activeUnit=r,!t.isOnline&&r.owner!==t.myName){var c=[t.myName,t.opponentName];t.opponentName=c[0],t.myName=c[1];var s=[t.spellPoints,t.opponentSpellPoints];t.opponentSpellPoints=s[0],t.spellPoints=s[1];var u=[t.opponentArtifacts,t.myArtifacts];t.myArtifacts=u[0],t.opponentArtifacts=u[1],t.lastAction+="The turn goes to ".concat(t.opponentName)}},attack:function(t,n){if(!t.activeUnit)throw Error("No active unit found!");var e=n.payload,a=e.attacker,i=e.defender,r=a.id,c=i.id,s=t.units,u=s.find((function(t){return t.id===r})),l=s.find((function(t){return t.id===c}));if(u&&l){var p=function(t,n){var e=Object(o.random)(t.attack.min*t.count,t.attack.max*t.count),a=n.defense*n.count,i=e-a>Math.ceil(.3*e)?e-a:Math.ceil(.3*e),r=n.healthPoints.current-i;if(r>0)return{totalDamagePoints:i,unitsKilled:0,currentUnitHealthPoints:r};var c=i-n.healthPoints.current,s=Math.round(c/n.healthPoints.max)+1,u=Math.round(c%n.healthPoints.max);return{unitsKilled:s,currentUnitHealthPoints:n.healthPoints.max-u,totalDamagePoints:i}}(a,i),A=p.unitsKilled,f=p.currentUnitHealthPoints,m=p.totalDamagePoints;if(l.healthPoints.lastTakenDamage=m,l.healthPoints.current=f,l.count-=A,t.lastAction="".concat(i.unitType," of ").concat(i.owner," was attacked by ").concat(a.unitType," of ").concat(a.owner,"! ").concat(A," units was killed"),l.count<=0){var b;s.splice(s.indexOf(l),1),null===(b=t.deadUnits)||void 0===b||b.push(l);var h=i.coordinates,y=h.x,O=h.y;t.board[O][y]=d(c,i.unitType),t.lastAction="".concat(i.unitType," of ").concat(i.owner," was destroyed!")}t.activeUnit.actionPoints.current-=1}},checkForWinner:function(t,n){var e=n.payload,i=e.userName,r=e.opponentName,c=Object(o.partition)(t.units,(function(t){return t.owner===i})),s=Object(a.a)(c,2),u=s[0],l=s[1];t.activeUnit&&(0===u.length&&(t.winner=r),0===l.length&&(t.winner=i))},concede:function(t){t.winner=t.opponentName},startCastSpell:function(t,n){var e=n.payload,a=e.spellName,i=e.cost,o=e.effectSrc;t.spellStack.effectSrc=o,t.spellStack.cost=i,t.spellStack.isCasting=!0,t.spellStack.spellName=a},castSpell:function(t,n){var e=n.payload,a=e.x,i=e.y;if(!t.spellStack.spellName)return t;var o,r="Magic Arrow"===(o={spellName:t.spellStack.spellName,board:t.board,units:t.units,deadUnits:t.deadUnits,lastAction:t.lastAction,target:{x:a,y:i}}).spellName?p(o):o,c=r.board,s=r.units,u=r.deadUnits,l=r.lastAction;t.spellPoints.current-=t.spellStack.cost,t.spellStack.cost=0,t.spellPoints.isTired=!0,t.spellStack.isCasting=!1,t.spellStack.spellName=void 0,t.board=c,t.units=s,t.deadUnits=u,t.lastAction=l}}}),b=m.actions,h=b.initBoard,y=b.moveToSquare,O=b.nextTurn,v=b.attack,g=b.checkForWinner,j=b.concede,x=b.startCastSpell,P=b.castSpell;n.e=m.reducer},39:function(t,n,e){"use strict";n.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAASCAMAAABVab95AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABOUExURQAAAMenV//1yMmuWrGUQdW6bv761Zd9KdS1ZP/vrQEAApN2I8atUoZqG7OgT3taGAABAJ2DLPbejwEAAIpwH//rs7mjVIxzIa2USgAAAFC2u5EAAAAadFJOU/////////////////////////////////8AFCIA2gAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAF5JREFUGFc1zUcWwCAIANFJMaY307z/RQOorv4bUYCYD1TFUBdDUwyt65LB925oRuOknqXD4lcnXyLc9uMMaXaPrF7f6TKu22hXT6vF+Oq0MfJJzrwkJ1ouXM6QGQn8E50LS75LAwwAAAAASUVORK5CYII="},40:function(t,n,e){"use strict";n.a=e.p+"static/media/alagard.685ec71b.ttf"},41:function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"a",(function(){return r}));var a=e(5),i=e(14),o=function(t,n,e,o,r){return Boolean(function(t,n,e){for(var a=[],o=-e;o<=e;++o)for(var r=-e;r<=e;++r)a.push([t+o,n+r]);return a.filter((function(t){return t[0]<i.c&&t[1]<i.d}))}(t,n,r).find((function(t){var n=Object(a.a)(t,2),i=n[0],r=n[1];return e===i&&o===r})))},r=function(t,n,e,a){var i=Math.abs(t-e),o=Math.abs(n-a);return Math.max(i,o)}},44:function(t,n,e){"use strict";n.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAMAAADNlS1EAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADAUExURQIBAVA+AJd9KaWELaiMOcatUta6Y+LKdd3EdN7Eac61WrmjVLGZRUw5App7I3JYBFhBAGtTAMmuWuvPe//86v799//1yP/rsz8wADgqAIZqG4xzGf7jj//33v7247meSgEAAgAAAGJLAHthDmBIAzIkAQABAIpwH4BkCpN2I9S0XQQAAHJXABgAACoFAPTWgj0rDjEuB3tjAEAXAv7nogQBAaWUM3lQAQ8MBGVFGL2jS3NYCKyUO+fPgP761QAAAMvnF3oAAABAdFJOU////////////////////////////////////////////////////////////////////////////////////wDCe7FEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZklEQVQoUz3Rf3OcIBAGYEW8XwFdYi5B1Jwg0dqYqzbtJWmv3e//rbqYmfIPwzPsu8sQIUYxSxLG0812tz/cCElCluWg2G1xd7zfpQ+Z0BhFpakY4yLd1c3x7vjY1CcZYauNlVkMrjOV2fqnU0zlvRyszvIYvnT7cePsVyC08WDlqABc3piDe96uCKyPKykTLpop9S9FwNYTsphNk2jygzs/hEwLaU+3laq+Damal1oSRn672KDm+42a8fVHwNbXr/izhyS/vL0jPjVr+UexILak3iLi3KzdVTHTwcaJow3nR0fYq18BNeOXoJ9ofwtCbWQKHAiLT7zOaLvSsV1Oer4N2KrreemWZTGQxgnY0/qiD9HrYVk6qO4poOVruT9ZPZYdgNoQWu4DgtA6Yc47lzEGEDAqhRBXPiaXdPOnaf7WezFTZnn1WutpUt5LKVUXGmFfJpzTf7JsHIwxNCshtv+XtbZFxH/bJjlB8LSp8wAAAABJRU5ErkJggg=="},45:function(t,n,e){"use strict";var a,i,o,r,c=e(16),s=e(19),u=e(25),l=e(1),d=e(17),p=e(37),A=e(44),f=e(11),m=["Loading","Preparing for battle","Getting ready to fight","Sharpening swords","Rearranging stones on the board","Polishing the shields"],b=e(6),h=Object(d.a)(p.a)(a||(a=Object(c.a)([""]))),y=Object(d.a)(u.animated.div)(i||(i=Object(c.a)(["\n  font-size: 24px;\n  margin-top: 10px;\n"]))),O=d.a.div(o||(o=Object(c.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n"]))),v=Object(d.a)(u.animated.img)(r||(r=Object(c.a)(["\n  width: 40px;\n"])));n.a=function(t){var n=t.style,e=Object(s.useSpring)({loop:!0,from:{rotateZ:0},to:{rotateZ:180}}),a=Object(s.useSpring)({loop:{reverse:!0},config:{duration:1e3},from:{opacity:0},to:{opacity:1}}),i=Object(l.useMemo)((function(){return Object(f.sample)(m)}),[]);return Object(b.jsx)(h,{customBackgroundStyle:n,children:Object(b.jsxs)(O,{children:[Object(b.jsx)(v,{src:A.a,style:e}),Object(b.jsx)(y,{style:a,children:i})]})})}},66:function(t,n,e){"use strict";e.r(n);var a=e(1),i=e.n(a),o=e(18),r=e.n(o),c=function(t){t&&t instanceof Function&&e.e(5).then(e.bind(null,78)).then((function(n){var e=n.getCLS,a=n.getFID,i=n.getFCP,o=n.getLCP,r=n.getTTFB;e(t),a(t),i(t),o(t),r(t)}))},s=e(23),u=e(38),l=Object(s.b)({name:"user",initialState:{nickname:"admin"},reducers:{login:function(t,n){var e=n.payload.nickname;t.nickname=e},logout:function(t){t.nickname=""}}}),d=l.actions,p=(d.login,d.logout,l.reducer),A=Object(s.a)({reducer:{game:u.e,user:p}}),f=e(36),m=e(45),b=e(6),h=i.a.lazy((function(){return Promise.all([e.e(3),e.e(4)]).then(e.bind(null,79))}));r.a.render(Object(b.jsx)(f.a,{store:A,children:Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(i.a.Suspense,{fallback:m.a,children:Object(b.jsx)(h,{})})})}),document.getElementById("root")),c()}},[[66,1,2]]]);
//# sourceMappingURL=main.41abad50.chunk.js.map